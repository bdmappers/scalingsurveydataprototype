<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="stylesheet" href="css/leaflet.css">
        <link rel="stylesheet" href="css/qgis2web.css">
        <link rel="stylesheet" href="css/leaflet-measure.css">
				<link rel="stylesheet" href="css/sidebar.css">
				<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet-sidebar-v2@3.0.2/css/leaflet-sidebar.min.css" integrity="sha384-EPNnjUWfl6+wmqeqVBLV1haeIrms6PXl67DNZ/RVCsfkwT78QX2fe16Gxidc6UOF" crossorigin="" />
				<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" integrity="sha384-X7L1bhgb36bF1iFvaqvhgpaGpayKM+vXNNYRlF89BFA5s3vi1qZ8EX9086RlZjy1" crossorigin="" />
				
        <style>
        html, body, #map {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
        }
        </style>
        <title></title>
    </head>
    <body>
			<div id="sidebar" class="leaflet-sidebar">
        <div class="leaflet-sidebar-tabs">
            <ul role="tablist">
                <li><a href="#home" role="tab"><i class="fa fa-bars"></i></a></li>
                <li><a href=#data-sources role="tab"><i class="fa fa-link"></i></a></li>
                <li><a href="#settings" role="tab"><i class="fa fa-filter"></i></a></li>
                <li><a href="#download" role="tab"><i class="fa fa-arrow-circle-down"></i></a></li>

            </ul>
            <ul role="tablist">
                <li><a href="#about" role="tab"><i class="fa fa-question-circle"></i></a></li>
            </ul>
        </div>
        <div class="leaflet-sidebar-content">
            <div class="leaflet-sidebar-pane active" id="home">
                <h1 class="leaflet-sidebar-header">
                     Prototype energy demand mapping
                    <div class="leaflet-sidebar-close"><i class="fa fa-times"></i></div>
                </h1>
                <p>The momentum behind SDG7 and Sustainable Energy for All (SE4ALL) underlines a global consensus that universal access to modern energy services is central to the sustainable development agenda and strongly cross-cutting with other sustainable development objectives and goals. Geospatial analysis has proven itself a crucial tool for planning, however, lack of high quality input data often impedes application of modern spatial planning tools.<br>
								<p>Nepal is currently on its transition to a lower-middle income country and puts strong efforts on improved energy access. Local and Provincial governments must now take the lead and make evidence-based decisions towards shaping their energy future. Currently, the capacities on these levels are still being developed, and the data necessary for making planning decisions severely lacking.<br>
								<p>This prototype provides the proof of concept for scaling representative primary data collected by leveraging remotely sensed population datasets. Such detailed data is a prerequisite for energy access planning in Nepal. We are currently seeking further funding to scale this approach to the Provincial level to deliver cost-effective data collection, extrapolation, harmonization, sharing tools for planning and project implementation for all governmental and non-governmental stakeholders working on energy access in Nepal.</p>               
                <p class="license"><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
            </div>

            <div class="leaflet-sidebar-pane" id="data-sources">
                <h1 class="leaflet-sidebar-header">Methodology<span class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
								<p>Household energy demand profiles were derived from the primary data. These are composed of primary cooking stove, current basic energy demand (which may be limited by supply technology) and future/supressed energy demand (which reflects the actual demand of each household, if there were no limitations in the supply). Moreover, household primary energy access technology were also determined. In parallel, household respective settlements were identified using remotely sensed population datasets.<br>
								<p>Using the estimated energy demand profile, the primary energy access technology and the respective location of each household, we were then able to classify each settlement by the typical energy access technology and assign a predominant cookstove technology to it, as well as determine its median current and future energy demand.<br>
								<p>Finally, through remotely sensed population datasets we were able to determine the total number of household per each settlement and, consequently, estimate its total current and future energy demand.<br>
								This resulting low-barrier web-map enables administrative bodies to rapidly assess the energy access situation in each settlement without requiring GIS capacity building in the short-midterm.</p>

								</div>
            <div class="leaflet-sidebar-pane" id="settings">
                <h1 class="leaflet-sidebar-header">Layers<span class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
                 <p><h3>Turn on and off layers</h3>
								On the right side, the different information layer on status of energy supply and type of cooking energy can be selected. Selecting either electricity or cooking access checkboxes enables the end-user to visualise access to energy carriers by colour.<br>
				
								<p><h3>Detailed Pop-ups</h3> 
								By clicking on a settlement cluster, detailed information on its characteristics and energy demand profile is provided.
								In particular, per each settlement, it reports: estimated number of households, predominant cooking stove, median current basic energy demand (which may be limited by supply technology), median future/supressed energy demand (which reflects the actual demand of each household, if there were no limitations in the supply) as well as total basic and future household electricity demand.<br>

                <br>
            </div>
            <div class="leaflet-sidebar-pane" id="about">
                <h1 class="leaflet-sidebar-header">
                     About the map
                    <div class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></div>
                </h1>
               <p><a href="https://reiner-lemoine-institut.de/" target="_blank">Reiner Lemoine Institut gGmbH (RLI)</a> is an independent non-profit research institution whose mission is to find paths to a sustainable energy supply based on 100 % renewable energy sources. The Off-grid Systems research group within the RLI supports the development of sustainable energy supply for remote regions by combining primary data collection with geospatial analysis and energy system simulations.</p>
								<p>Kathmandu Living Labs (KLL) is a civic technology company. KLL activates, inspires, and leads a community of young changemakers who are excited about using high impact technology to transform our societies. KLL creates the digital infrastructure so that government, non-profits and businesses can use 21st century tools to provide everyday citizens with better services.</p>
								<p>Flowminder Foundation is a non-profit organisation whose mission is to improve public health and welfare in low- and middle-income countries. Flowminder work with governments, inter-governmental organisations and NGOs to collect, aggregate, integrate and analyse anonymous mobile operator data, satellite and household survey data.</p>
								<p>Alternative Energy Promotion Centre, Government of Nepal (AEPC) functions under the Ministry of Energy, Water Resources and Irrigation, their mission is to make renewable energy mainstream resource through increased access, knowledge and adaptability contributing to the improved living conditions of people in Nepal.</p>
								<p>Renewable Energy for Rural Livelihoods (RERL)is a joint project of Government of Nepal, UNDP and GEF and supports AEPC in remove barriers for scaling up of interventions to promote less disseminated larger renewable energy systems.
								Ministry of Physical Infrastructure Development in Province 7 is responsible for overall development of infrastructure including provincial energy planning. The province has one of the lowest energy access in the country while having a large potential for both large and small scale renewable energy resources. </p>
								<p>Deutsche Gesellschaft f√ºr Internationale Zusammenarbeit GmbH (GIZ Nepal) under the project Renewable Energy for Rural Areas (RERA) aims to ensure efficient and effective service delivery of small-scale renewable energy through improved outreach and enhanced local cooperation in a federalized and decentralized Nepal. </p>
                
            </div>
            <div class="leaflet-sidebar-pane" id="download">
                <h1 class="leaflet-sidebar-header">
                        Data sources
                        <div class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></div>
                    </h1>
                <p><p>The spatially disaggregated dataset used for the analysis results from the combination of primary survey data with remotely sensed population datasets. 
								The survey data were collected between January and July 2018 through an energy demand survey method aligned with the World Bank multi-tier framework which was successfully applied across 14 pilot municipalities. Sampling strata of 400 households per municipality (5,600 households in total) were generated using the novel gridded spatial sampling method (<a href="http://GridSample.org" target="_blank">GridSample.org</a>).
								<p>As for remotely sensed population datasets, they are available and were downloaded from the following sources: 
								<a href="https://www.openstreetmap.org" target="_blank">OpenStreetMap</a><br> and <a href="http://www.worldpop.org.uk/" target="_blank">WorldPop</a>.<br></p>
								
                <p class="license"><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
            </div>
        </div>
</div>
		
		
		
        <div id="map">
        </div>
        <script src="js/qgis2web_expressions.js"></script>
        <script src="js/leaflet.js"></script>
        <script src="js/leaflet.rotatedMarker.js"></script>
        <script src="js/leaflet.pattern.js"></script>
        <script src="js/leaflet-hash.js"></script>
        <script src="js/Autolinker.min.js"></script>
        <script src="js/rbush.min.js"></script>
        <script src="js/labelgun.min.js"></script>
        <script src="js/labels.js"></script>
        <script src="js/leaflet-measure.js"></script>
        <script src="data/Municipality_1.js"></script>
        <script src="data/CookingAccess_2.js"></script>
        <script src="data/ElectricityAccess_3.js"></script>
				<script src="https://cdn.jsdelivr.net/npm/leaflet-sidebar-v2@3.0.2/js/leaflet-sidebar.min.js" integrity="sha384-LzTQ6yhqVy/ipjMq5MMk98mo0E64Wtu9K1Jm5OeKPolnqrlv3FMdc457RoOANGMb" crossorigin=""></script>
        <script>
				
        var map = L.map('map', {
            zoomControl:true, maxZoom:28, minZoom:1
        })
				
				let sidebar = L.control.sidebar({
            container: "sidebar",
            closeButton: true,
            position: "left"
        }).addTo(map);
				
				
        var hash = new L.Hash(map);
        map.attributionControl.addAttribution('<a href="https://github.com/tomchadwin/qgis2web" target="_blank">qgis2web</a>');
        var measureControl = new L.Control.Measure({
            primaryLengthUnit: 'meters',
            secondaryLengthUnit: 'kilometers',
            primaryAreaUnit: 'sqmeters',
            secondaryAreaUnit: 'hectares'
        });
        measureControl.addTo(map);
        var bounds_group = new L.featureGroup([]);
        function setBounds() {
            if (bounds_group.getLayers().length) {
                map.fitBounds(bounds_group.getBounds());
            }
        }
        var overlay_OpenStreetMap_0 = L.tileLayer('http://a.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            opacity: 1.0
        });
        overlay_OpenStreetMap_0.addTo(map);
        map.addLayer(overlay_OpenStreetMap_0);
        function pop_Municipality_1(feature, layer) {
            var popupContent = '<table>\
                    <tr>\
                        <td colspan="2"><strong>DISTRICT</strong><br />' + (feature.properties['DISTRICT'] !== null ? Autolinker.link(String(feature.properties['DISTRICT'])) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2"><strong>Municip.</strong><br />' + (feature.properties['Municip.'] !== null ? Autolinker.link(String(feature.properties['Municip.'])) : '') + '</td>\
                    </tr>\
                </table>';
            layer.bindPopup(popupContent, {maxHeight: 400});
        }

        function style_Municipality_1_0() {
            return {
                pane: 'pane_Municipality_1',
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fillOpacity: 0,
            }
        }
        map.createPane('pane_Municipality_1');
        map.getPane('pane_Municipality_1').style.zIndex = 401;
        map.getPane('pane_Municipality_1').style['mix-blend-mode'] = 'normal';
        var layer_Municipality_1 = new L.geoJson(json_Municipality_1, {
            attribution: '<a href=""></a>',
            pane: 'pane_Municipality_1',
            onEachFeature: pop_Municipality_1,
            style: style_Municipality_1_0,
        });
        bounds_group.addLayer(layer_Municipality_1);
        map.addLayer(layer_Municipality_1);
        function pop_CookingAccess_2(feature, layer) {
            var popupContent = '<table>\
                    <tr>\
                        <td colspan="2"><strong>ClusterID</strong><br />' + (feature.properties['ClusterID'] !== null ? Autolinker.link(String(feature.properties['ClusterID'])) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2"><strong>Households</strong><br />' + (feature.properties['Households'] !== null ? Autolinker.link(String(feature.properties['Households'])) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2"><strong>Typical Cooking Stove</strong><br />' + (feature.properties['Typical Cooking Stove'] !== null ? Autolinker.link(String(feature.properties['Typical Cooking Stove'])) : '') + '</td>\
                    </tr>\
                </table>';
            layer.bindPopup(popupContent, {maxHeight: 400});
        }

        function style_CookingAccess_2_0(feature) {
            switch(String(feature.properties['Typical Cooking Stove'])) {
                case 'Unimproved':
                    return {
                pane: 'pane_CookingAccess_2',
                opacity: 1,
                color: 'rgba(215,25,28,1.0)',
                dashArray: '',
                lineCap: 'square',
                lineJoin: 'bevel',
                weight: 1.0,
                fillOpacity: 0,
            }
                    break;
                case 'ICS':
                    return {
                pane: 'pane_CookingAccess_2',
                opacity: 1,
                color: 'rgba(104,104,0,1.0)',
                dashArray: '',
                lineCap: 'square',
                lineJoin: 'bevel',
                weight: 1.0,
                fillOpacity: 0,
            }
                    break;
                case 'BLENs':
                    return {
                pane: 'pane_CookingAccess_2',
                opacity: 1,
                color: 'rgba(43,131,186,1.0)',
                dashArray: '',
                lineCap: 'square',
                lineJoin: 'bevel',
                weight: 1.0,
                fillOpacity: 0,
            }
                    break;
            }
        }
        map.createPane('pane_CookingAccess_2');
        map.getPane('pane_CookingAccess_2').style.zIndex = 402;
        map.getPane('pane_CookingAccess_2').style['mix-blend-mode'] = 'normal';
        var layer_CookingAccess_2 = new L.geoJson(json_CookingAccess_2, {
            attribution: '<a href=""></a>',
            pane: 'pane_CookingAccess_2',
            onEachFeature: pop_CookingAccess_2,
            style: style_CookingAccess_2_0,
        });
        bounds_group.addLayer(layer_CookingAccess_2);
        function pop_ElectricityAccess_3(feature, layer) {
            var popupContent = '<table>\
                    <tr>\
                        <td colspan="2"><strong>ClusterID</strong><br />' + (feature.properties['ClusterID'] !== null ? Autolinker.link(String(feature.properties['ClusterID'])) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2"><strong>Households</strong><br />' + (feature.properties['Households'] !== null ? Autolinker.link(String(feature.properties['Households'])) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2"><strong>Electricity Access</strong><br />' + (feature.properties['Electricity Access'] !== null ? Autolinker.link(String(feature.properties['Electricity Access'])) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2"><strong>Typical Cooking Stove</strong><br />' + (feature.properties['Typical Cooking Stove'] !== null ? Autolinker.link(String(feature.properties['Typical Cooking Stove'])) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2"><strong>Median Household Minimum Demand (Wp)</strong><br />' + (feature.properties['Median Household Minimum Demand (Wp)'] !== null ? Autolinker.link(String(feature.properties['Median Household Minimum Demand (Wp)'])) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2"><strong>Median Household Future/Supressed Demand (Wp)</strong><br />' + (feature.properties['Median Household Future/Supressed Demand (Wp)'] !== null ? Autolinker.link(String(feature.properties['Median Household Future/Supressed Demand (Wp)'])) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2"><strong>Approx. Total Minimum Household Demand (kWp)</strong><br />' + (feature.properties['Approx. Total Minimum Household Demand (kWp)'] !== null ? Autolinker.link(String(feature.properties['Approx. Total Minimum Household Demand (kWp)'])) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2"><strong>Approx. Total Future/Supressed Household Demand (kWp)</strong><br />' + (feature.properties['Approx. Total Future/Supressed Household Demand (kWp)'] !== null ? Autolinker.link(String(feature.properties['Approx. Total Future/Supressed Household Demand (kWp)'])) : '') + '</td>\
                    </tr>\
                </table>';
            layer.bindPopup(popupContent, {maxHeight: 400});
        }

        function style_ElectricityAccess_3_0(feature) {
            switch(String(feature.properties['Electricity Access'])) {
                case 'Off-Grid':
                    return {
                pane: 'pane_ElectricityAccess_3',
                opacity: 1,
                color: 'rgba(255,158,1,1.0)',
                dashArray: '',
                lineCap: 'square',
                lineJoin: 'bevel',
                weight: 1.0,
                fillOpacity: 0,
            }
                    break;
                case 'Mini-Grid':
                    return {
                pane: 'pane_ElectricityAccess_3',
                opacity: 1,
                color: 'rgba(32,144,141,1.0)',
                dashArray: '',
                lineCap: 'square',
                lineJoin: 'bevel',
                weight: 1.0,
                fillOpacity: 0,
            }
                    break;
                case 'Grid':
                    return {
                pane: 'pane_ElectricityAccess_3',
                opacity: 1,
                color: 'rgba(68,1,84,1.0)',
                dashArray: '',
                lineCap: 'square',
                lineJoin: 'bevel',
                weight: 1.0,
                fillOpacity: 0,
            }
                    break;
            }
        }
        map.createPane('pane_ElectricityAccess_3');
        map.getPane('pane_ElectricityAccess_3').style.zIndex = 403;
        map.getPane('pane_ElectricityAccess_3').style['mix-blend-mode'] = 'normal';
        var layer_ElectricityAccess_3 = new L.geoJson(json_ElectricityAccess_3, {
            attribution: '<a href=""></a>',
            pane: 'pane_ElectricityAccess_3',
            onEachFeature: pop_ElectricityAccess_3,
            style: style_ElectricityAccess_3_0,
        });
        bounds_group.addLayer(layer_ElectricityAccess_3);
        map.addLayer(layer_ElectricityAccess_3);
        var baseMaps = {};
        L.control.layers(baseMaps,{'Electricity Access<br /><table><tr><td style="text-align: center;"><img src="legend/ElectricityAccess_3_OffGridSolar0.png" /></td><td>Off-Grid Solar</td></tr><tr><td style="text-align: center;"><img src="legend/ElectricityAccess_3_MiniGrid1.png" /></td><td>Mini-Grid</td></tr><tr><td style="text-align: center;"><img src="legend/ElectricityAccess_3_Grid2.png" /></td><td>Grid</td></tr></table>': layer_ElectricityAccess_3,'Cooking Access<br /><table><tr><td style="text-align: center;"><img src="legend/CookingAccess_2_Unimproved0.png" /></td><td>Unimproved</td></tr><tr><td style="text-align: center;"><img src="legend/CookingAccess_2_ICS1.png" /></td><td>ICS</td></tr><tr><td style="text-align: center;"><img src="legend/CookingAccess_2_BLENs2.png" /></td><td>BLENs</td></tr></table>': layer_CookingAccess_2,'<img src="legend/Municipality_1.png" /> Municipality': layer_Municipality_1,"OpenStreetMap": overlay_OpenStreetMap_0,},{collapsed:false}).addTo(map);
        setBounds();
        </script>
    </body>
</html>
